<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<link href="polyfill.css" rel="stylesheet">
		<script src="polyfill.js"></script>
		<style>
		#stats {
			background-color: #FFF;
			color: #333;
			left: 0;
			right: 0;
			margin: 0;
			overflow: hidden;
			position: fixed;
			z-index: 1;
			top: 0;
		}
		</style>
		<script>
		document.addEventListener('DOMContentLoaded', function () {
			var h1 = document.body.querySelectorAll('p, h1')[0];

			if (h1.matches('body > h1[class^="fo"]') && !h1.matches('body > h1[class$="of"]')) {
				h1.classList.remove('foo');

				h1.innerHTML = '<mark>'+h1.innerHTML+'</mark>';

				h1.addEventListener('click', function (event) {
					var pre = document.querySelector('pre#stats');

					pre.innerHTML = [
						'event.timeStamp: '+event.timeStamp,
						'event.target.nodeName: '+event.target.nodeName,
						'event.currentTarget.nodeName: '+event.currentTarget.nodeName,
						'event.currentTarget.innerHTML: '+event.currentTarget.innerHTML.replace(/</g, '&lt;')
					].join('<br>');

					document.body.style.marginTop = getComputedStyle(pre).height;
				});
			}

			if (window.matchMedia) {
				var listFn = function (list) {
					document.getElementById('media').innerHTML = list.matches ? 'Yes' : 'No';
				};

				var list = window.matchMedia('(min-width: 50em)');

				list.addListener(listFn);

				listFn.call(window, list);
			}
		});
		</script>
		<title>polyfill test</title>
	</head>
	<body>
		<pre id="stats"></pre>
		<h1 class="foo">Click this test of polyfill.js.</h1>
		<p hidden>You can't see this.</p>
		<p><input placeholder="Placeholder text..."></p>
		<script>
		(function () {
			function onchange() {
				pre.innerHTML = [
					'window.innerWidth: ' + window.innerWidth,
					'window.innerHeight: ' + window.innerHeight,
					'window.scrollX: ' + window.scrollX,
					'window.scrollY: ' + window.scrollY
				].join('<br>');

				document.body.style.marginTop = getComputedStyle(pre).height;
			}

			var pre = document.querySelector('pre');

			window.addEventListener('resize', onchange);
			window.addEventListener('scroll', onchange);
		})();

		if (window.Event) {
			window.dispatchEvent(new window.Event('resize'));
		}

		window.addEventListener('hashchange', function () {
			if (window.location.hash === '#whereami') {
				var element = document.getElementById('coords');

				window.navigator.geolocation.getCurrentPosition(function (event) {
					element.innerHTML = 'We found you at ' + [event.coords.latitude, event.coords.longitude] + '.';
				}, function (event) {
					element.innerHTML = 'We could not find you, given that ' + [event.message] + '.';
				});
			}
		});
		</script>
		<p id="coords"><a href="#whereami">Where am I?</a></p>
		<p>After getting this sudden lesson in the power of terrestrial weapons, the Martians retreated to their original position upon Horsell Common; and in their haste, and encumbered with the debris of their smashed companion, they no doubt overlooked many such a stray and negligible victim as myself.  Had they left their comrade and pushed on forthwith, there was nothing at that time between them and London but batteries of twelve-pounder guns, and they would certainly have reached the capital in advance of the tidings of their approach; as sudden, dreadful, and destructive their advent would have been as the earthquake that destroyed Lisbon a century ago.</p>

		<p><a href="javascript:;" onclick="localStorage.setItem('thing', 'Ah yes, that was it.');">Remember something.</a></p>

		<p><a href="javascript:;" onclick="this.lastChild.innerHTML=localStorage.getItem('thing')||'I don\'t remember.'">Recall something. <span></span></a></p>

		<p><a href="javascript:;" onclick="localStorage.clear()">Forget everything.</a></p>

		<p>But they were in no hurry.  Cylinder followed cylinder on its interplanetary flight; every twenty-four hours brought them reinforcement.  And meanwhile the military and naval authorities, now fully alive to the tremendous power of their antagonists, worked with furious energy.  Every minute a fresh gun came into position until, before twilight, every copse, every row of suburban villas on the hilly slopes about Kingston and Richmond, masked an expectant black muzzle.  And through the charred and desolated area--perhaps twenty square miles altogether--that encircled the Martian encampment on Horsell Common, through charred and ruined villages among the green trees, through the blackened and smoking arcades that had been but a day ago pine spinneys, crawled the devoted scouts with the heliographs that were presently to warn the gunners of the Martian approach.  But the Martians now understood our command of artillery and the danger of human proximity, and not a man ventured within a mile of either cylinder, save at the price of his life.</p>

		<p>Is (min-width: 50em)? <span id="media">It's unavailable</span>.</p>

		<p>It would seem that these giants spent the earlier part of the afternoon in going to and fro, transferring everything from the second and third cylinders--the second in Addlestone Golf Links and the third at Pyrford--to their original pit on Horsell Common.  Over that, above the blackened heather and ruined buildings that stretched far and wide, stood one as sentinel, while the rest abandoned their vast fighting-machines and descended into the pit.  They were hard at work there far into the night, and the towering pillar of dense green smoke that rose therefrom could be seen from the hills about Merrow, and even, it is said, from Banstead and Epsom Downs.</p>

		<p>And while the Martians behind me were thus preparing for their next sally, and in front of me Humanity gathered for the battle, I made my way with infinite pains and labour from the fire and smoke of burning Weybridge towards London.</p>

		<p>I saw an abandoned boat, very small and remote, drifting down-stream; and throwing off the most of my sodden clothes, I went after it, gained it, and so escaped out of that destruction.  There were no oars in the boat, but I contrived to paddle, as well as my parboiled hands would allow, down the river towards Halliford and Walton, going very tediously and continually looking behind me, as you may well understand.  I followed the river, because I considered that the water gave me my best chance of escape should these giants return.</p>

		<p>The hot water from the Martian's overthrow drifted downstream with me, so that for the best part of a mile I could see little of either bank.  Once, however, I made out a string of black figures hurrying across the meadows from the direction of Weybridge.  Halliford, it seemed, was deserted, and several of the houses facing the river were on fire.  It was strange to see the place quite tranquil, quite desolate under the hot blue sky, with the smoke and little threads of flame going straight up into the heat of the afternoon.  Never before had I seen houses burning without the accompaniment of an obstructive crowd.  A little farther on the dry reeds up the bank were smoking and glowing, and a line of fire inland was marching steadily across a late field of hay.</p>
	</body>
</html>
